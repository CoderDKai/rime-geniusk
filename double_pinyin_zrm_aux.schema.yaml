# Rime schema
# encoding: utf-8
#
# geniusk è‡ªç„¶ç åŒæ‹¼ + è‡ªç„¶ç è¾…åŠ©ç 
# åŸºäº rime-shuangpin-fuzhuma å’Œé›¾å‡‡æ‹¼éŸ³

schema:
  schema_id: double_pinyin_zrm_aux
  name: "è‡ªç„¶ç +è¾…ç "
  version: "1.0"
  author:
    - geniusk
  description: |
    è‡ªç„¶ç åŒæ‹¼ + è‡ªç„¶ç è¾…åŠ©ç 
    è¾…ç æ¥æºï¼šrime-shuangpin-fuzhuma
  dependencies:
    - melt_eng


# å¼€å…³è®¾ç½®
switches:
  - name: ascii_mode
    states: [ åŒ, A ]
  - name: ascii_punct
    states: [ Â¥, $ ]
  - name: traditionalization
    states: [ ç®€, ç¹ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]


# è¾“å…¥å¼•æ“
engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - table_translator@melt_eng
    - table_translator@custom_phrase
  filters:
    - simplifier@emoji
    - simplifier@traditionalize
    - uniquifier


# æ‹¼å†™è®¾å®š - è‡ªç„¶ç åŒæ‹¼ + è¾…åŠ©ç 
speller:
  max_code_length: 5
  auto_select: false
  alphabet: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA[/
  initials: zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA
  delimiter: " '"
  algebra:
    # å¼•ç”¨è‡ªç„¶ç åŒæ‹¼è½¬æ¢è§„åˆ™
    __include: moqi_speller.yaml:/zrm_speller


# è¾…ç è§„åˆ™å®šä¹‰ï¼ˆç”¨äº __patch è¿½åŠ ï¼‰
zrm_aux_patch:
  __include: moqi_speller.yaml:/zrm_aux
  __append:
    # è‡ªå®šä¹‰è¾…ç è¾“å…¥è§„åˆ™ï¼ˆä½¿ç”¨ derive æ›¿ä»£ abbrevï¼Œå…è®¸æ•´å¥ä¸­ä½¿ç”¨2ä½è¾…ç ï¼‰
    - derive/^(.{2}|\w+?);.*$/$1/                    # çº¯åŒæ‹¼
    - derive/^(.{2}|\w+?);(\w)(\w).*$/$1$2/          # åŒæ‹¼+1ä½è¾…ç 
    - derive/^(.{2}|\w+?);(\w)(\w).*$/$1[$2/         # åŒæ‹¼+[+1ä½è¾…ç 
    - derive/^(.{2}|\w+?);(\w)(\w).*$/$1$2$3/        # åŒæ‹¼+2ä½è¾…ç ï¼ˆæ”¹ç”¨deriveï¼‰
    - derive/^(.{2}|\w+?);(\w)(\w).*$/$1$2$3o/       # åŒæ‹¼+2ä½è¾…ç +o
    - derive|^(.{2}|\w+?);(\w)(\w).*$|$1$2$3/|       # åŒæ‹¼+2ä½è¾…ç +/


# è¿½åŠ è¾…ç è§„åˆ™åˆ° speller/algebra
__patch:
  speller/algebra/+:
    __include: zrm_aux_patch


# ä¸»ç¿»è¯‘å™¨
translator:
  dictionary: double_pinyin_zrm_aux
  prism: double_pinyin_zrm_aux
  enable_user_dict: true
  enable_completion: true
  initial_quality: 100
  spelling_hints: 1
  comment_format:
    # æå–è‡ªç„¶ç è¾…ç ï¼ˆç¬¬4ä¸ªåˆ†å·åˆ†éš”çš„å­—æ®µï¼‰å¹¶æ˜¾ç¤º
    - xform/^[^;]+;[^;]+;[^;]+;([^;,]+).*$/[$1]/
    # å¦‚æœä¸æƒ³æ˜¾ç¤ºä»»ä½•æ³¨é‡Šï¼Œå–æ¶ˆä¸‹é¢è¿™è¡Œçš„æ³¨é‡Šï¼š
    # - xform/.*//


# è‹±æ–‡ç¿»è¯‘å™¨
melt_eng:
  dictionary: melt_eng
  enable_sentence: false
  enable_user_dict: false
  enable_completion: false
  initial_quality: 0.5
  comment_format:
    - xform/.*//


# è‡ªå®šä¹‰çŸ­è¯­
custom_phrase:
  dictionary: ""
  user_dict: geniusk_custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 99


# Emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json
  tips: none


# æ ‡ç‚¹ç¬¦å·
punctuator:
  import_preset: default


# å¿«æ·é”®
key_binder:
  import_preset: default
  bindings:
    - { when: has_menu, accept: semicolon, send: 2 }
    - { when: composing, accept: Control+1, send_sequence: '{Home}{Shift+Right}[' }
    - { when: composing, accept: Control+2, send_sequence: '{Home}{Shift+Right}{Shift+Right}[' }
    - { when: composing, accept: Control+3, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}[' }


# è¯†åˆ«å™¨
recognizer:
  import_preset: default
